
**指令规划**
0          7          15         23         31
+----------+----------+----------+----------+
|   CMD    |   IVAL   |   REG1   |   REG2   |
+----------+----------+----------+----------+
CMD:  机器指令码
IVAL: 局部变量表索引
REG1: 操作寄存器1
REG2: 操作寄存器2

**设计思路**

```mermaid
graph LR
A["读取脚本文件(Parser)"]
B["读取块"]
C1["读取表达式"]
C2["读取函数"]
D["创建虚拟机(VM)"]
E1["计算表达式"]
E2["执行函数"]
F["接收结果(Runner)"]

A-->B
B-->C1
B-->C2
C1-->D
C2-->D
D-->E1
D-->E2
E1-->F
E2-->F

```

**表达式计算框架**
```mermaid
graph LR
A["编译(translate)"]
B1["声明(VAR)"]
B2["函数(FUNC)"]
B3["值(VALUE)"]
B4["表达式(EXPRESSION)"]
C["生成指令"]
A-->B3-->B1
B3-->B2
A-->B4-->B1
B4-->B2
B1-->C1["入常量池"] --> C
B2-->C2["调用函数"] --> C
C --> D["执行指令"]
```

**指令执行过程**

```mermaid
graph LR
A[读取指令]
B[执行指令]
C[异常检测]

A-->B-->C-->A
```
