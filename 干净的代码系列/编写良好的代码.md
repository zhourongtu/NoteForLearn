# 原则
参考书目：
- 《代码大全》
- 《代码整洁之道》
- 《重构》


一些提醒
- 命名准确
- 代码存在于应该存在的位置
- 没有脏东西
- 遵循规则
- 保持遵守规则的心
  - 将需求明确到机器可以正确执行的细节程度，就是 "编程" 要做的事。
  - 稍后等于永不。除非重构——即新需求的到来，需要修改旧的代码满足新的需求。
  - 程序员维护代码的设计应该报以极大的热情，如同项目经理保持进度一样。（医生做手术前洗手）
  - 制造混乱会让程序员失去对进度的把控，做的快的唯一方法就是尽可能保持代码整洁。

# 分类

## 命名
- 怎样是好的变量命名？（坏的命名就是不满足好的命名的条件）
- 变量命名中可能犯的错误。
- 一些手段，辅助尽可能写出好的命名，避免可能犯的错误。

1. 最重要的命名注意事项
  - 该名字应该完全、准确地描述出该变量所代表的事务。
2. 命名注意事项
  - 内容、数据种类(具名常量、简单变量、用户自定义类型或类)
  - 类型
    - 函数：参数、返回值、函数名
  - 长度
  - 含义
  - 作用域（私用、类、包或者全局）
3. 命名错误样例
  - 名不副实、误导、思维映射（按照旧惯例）、区分度低、阅读困难、不可查找、无意义编码（命名方式、前缀、接口与实现）
  - 不够严肃
  - 双关、领域类命名使用不当（程序员使用程序员、其他领域可参考其他领域）
4. 命名参考习惯
   - 一些方式
     - 描述性的名称、以问题为导向
   - 变量
     - 后置计算值限定词（Total、Sum、Average、Max、Min、Record、String、Pointer），含义先行。（num是例外-->Index、Count、Total来避免）
     - 对仗词参考
       - begin/end、first/last、locked/unlocked、min/max、next/previous、old/new、opened/closed、visible/invisible、source/target、source/destination、up/down
     - 特定类型
       - 循环下标(i、j、k、xxxIndex)、状态变量(有点像枚举)、临时变量(**不能随意命名**)
       - 布尔变量：donw、error、found、success、ok（赋予真假的含义）
       - 枚举类型：组前缀、类空间
       - 常量
   - 类、对象：名词、名词短语。
   - 函数、方法
     - 动词、动词短语、动词+关键词。
     - TO（向下规则）：To...., we....

### 辅助手段
- 命名空间
- 命名规则（为什么、何时、如何创建自己的变量命名标准）
  - why？
    - 全局决策代替局部决策，集中精力。(韦易笑有类似的看法)
    - 更快、更容易了解不同项目或不同人写出的代码。
    - 减少名字的增生。
    - 弥补程序语言的不足。可以用规则来效仿具名常量和枚举类型。规则可以根据局部数据、类数据以及全局数据的不同而有所差别，并且可以包含编译器不直接提供的信息。
      - 强调相关变量之间的关系(如employeeAddress、employeePhone)。（用命名规则补充编程语言的缺憾）
  - when？
    - 多人协作、计划性转交程序(维护)、code review、程序规模大、程序生命周期长。
    - 术语：标准术语或缩写。
  - 正式程度：人员数量、程序规模、生命周期。
- 如何创建自己的变量命名标准
  - 参考一：非正式命名规则
    - 语言无关规则
      - 变量名与子程序区分
      - 类和对象区分(大小写开头、全大写、t_前缀、a前缀、命名含义)
        - 优缺点：（大小写不敏感语言、常量惯例、审美、多实例、普通情况下不适用，太纯粹了）
      - 全局变量、成员变量、类型声明、常量、枚举
      - 语言特征：只读参数、传递方式（by值、by引用）
  - 参考二：混合语言编程注意事项
	- 做优化。（可能与语言相关规则冲突，但不重要）
  - C#命名规范思考：
    - TODO...
- 标准前缀（感觉不具有太高价值，因为所谓的标准并不是真正的标准）
  - 用户自定义类型（UDT）的缩写和语义前缀。
    - UDT缩写（文字处理程序有一个例子src、doc、ch、sel（选中范围）、wn、pa...）
    - 语义前缀：c、first、g、i、last、lim、m、max、min、p


## 函数
- 1.足够短小，且只做一个抽象层的事情。
  - （BattleModePanel的很多函数违反了这个原则，导致很多代码非常冗余）
  - （原来写的按时间划分的，尽管同时存在函数、set等，均只是做一个抽象层级的事情，最多只是做了诠释代码的含义）
- 2.了解为什么编写函数-->将所有的函数尽可能符合上述的原则，足够短小且只做一件事，尽可能写成一元函数，并满足一元函数的形式。
  - 一元函数
    - 询问参数的问题1、操作该参数2、事件3。
    - 减少非前面形式的一元函数（处理，但不作为返回值返回）
      - 这个形式是经常使用的，并总是出现在代码中，很难避免这件事。
      - 1+2，互相干扰导致混乱（经常写这样的代码，得万分注意）
    - 2形式的一元函数“可以利用”对象来避免输出参数。
  - 标识参数(传入布尔值)、三元函数、参数列表-->往一元函数的方向靠拢。
    - 拆成两个函数？
  - （命名上参考命名相关内容）
- 3.错误样例
  - 多区段（无休止的//区分）、多抽象层级
- 4.switch的重构
  - 原因：违反单一权责原则（Single Responsibility Principle、SRP）、开放闭合原则（Open Closed Principle、OCP）
  - 方式：多态、抽象工厂。
- 5.其他
  - 异常和错误码？
    - 异常替代错误码可以简化主逻辑。

## 注释

## 代码格式

## 对象和数据结构

## 错误处理

## 边界问题

## 单元测试

## 类

## 系统

## 并发编程


## 概念解释
- TDD(Test-Driven Development)测试驱动开发
- DefensiveProgramming 防御式编程
- 函数式编程
  - 闭包（闭包起函数的作用，并可以像操作对象一样操作函数）
    - 支持函数称为第一类对象，称为“闭包”或“仿函数对象”
  - 高阶函数
    - 可以由另一个函数作为输入参数，允许返回一个函数作为输出参数。
  - 惰性计算
    - 表达式不再绑定到变量时进行计算，而是在求值程序需要产生表达式的值时，进行计算。
    - 允许编写生成无穷输出的函数（不会计算多于程序的其余部分所需要的值）


# 重构技巧

## 数据与操作
- 1.函数组合成类
- 2.函数组合成变换

## 简化条件逻辑

- 1.以多态取代条件表达式（函数避免做多件事、开闭原则、单一职责原则）
  - 具体情况
    - 条件逻辑-->不做说明
    - 基础逻辑+变体逻辑（条件逻辑）
  - 代替方案：工厂函数、查表（我个人认为、《代码大全》）
  - 基础+变体操作：
    1. 函数组合成类
    2. 抽取基础逻辑，提取变体逻辑。
    3. 写工厂函数。
    4. 覆写变体逻辑
      - 较为复杂则再提取函数，再在细粒度写变体逻辑。
  - 案例分析：船长是否去过中国，是否到中国的行程。
- 2.引入特例
  - 